<div class="row">
    <div class="col-md-12">
        <ol class="breadcrumb">
            <li><a href="/end">首页</a></li>
            <li>文字</li>
            <li class="active">{{title}}</li>
        </ol>

        <!--面板-->
        <h1 class="page-title">{{title}}</h1>
        <div class="panel panel-default">
            <div class="panel-body">
                <form role="form" class="form-horizontal" id="form_post">
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">标题</label>
                        <div class="col-xs-10">
                            <input type="text" name="title" class="form-control" value="{{post.title}}"/>
                        </div>
                    </div>
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">ID</label>
                        <div class="col-xs-10">
                            <input type="text" class="form-control" disabled value="{{post._id}}"/>
                            <input type="text" name="id" class="hidden" value="{{post._id}}"/>
                        </div>
                    </div>

                    <div class="form-group col-sm-12">
                        <label class="control-label col-xs-1">正文</label>
                        <div class="col-xs-11">
                            <textarea rows="20" name="content" class="form-control">{{post.content}}</textarea>
                        </div>
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="control-label col-xs-1">概要</label>
                        <div class="col-xs-11">
                            <textarea rows="2" name="summary" class="form-control">{{post.summary}}</textarea>
                        </div>
                    </div>
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">日期</label>
                        <div class="col-xs-10">
                            <input type="text" name="date" class="form-control" value="{{post.date}}"/>
                        </div>
                    </div>
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">地址</label>
                        <div class="col-xs-10">
                            <input type="text" name="alias" class="form-control" value="{{post.alias}}"/>
                        </div>
                    </div>
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">分类</label>
                        <div class="col-xs-10">
                            <select multiple="multiple" name="topics" class="form-control multiselect multiselect-info">
                            {{#each topics}}
                            <option value="{{name}}" {{#if selected}}selected{{/if}}>{{name}}</option>
                            {{/each}}
                            </select>
                        </div>
                    </div>
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">标签</label>
                        <div class="col-xs-10">
                        <select multiple="multiple" name="tags" class="form-control multiselect multiselect-info">
                        {{#each tags}}
                        <option value="{{name}}" {{#if selected}}selected{{/if}}>{{name}}</option>
                        {{/each}}
                        </select>
                        </div>
                    </div>
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">公开</label>
                        <div class="col-xs-10">
                            <select name="ifpublic" class="form-control select select-primary select-block mbl" />
                                <option value="0">下线</option>
                                <option value="1" {{#if post.status}}selected{{/if}}>上线</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group col-sm-6">
                        <label class="control-label col-xs-2">安全</label>
                        <div class="col-xs-10">
                            <select name="ifsafe" class="form-control select select-primary select-block mbl" />
                                <option value="1">保护</option>
                                <option value="0" {{#if post.safestatus}}selected{{/if}}>解保</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-sm-5 col-sm-offset-1">
                        <button class="btn btn-primary btn-block" id="form_submit">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    $('#form_submit').click(function(event){
        event.preventDefault();
        var params = $('form').serializeObject();
        if (params.title == '' || params.content == '' || params.alias == '' || params.date == '' || params.summary == '') {
            alert('有必填项目没有填写');
        } else {
            $.post('/end/editBlog',
            params,
            function (data, status) {
                if (status == 'success') {
                    location.href='/end/preview/' + data.alias;
                } else {
                    alert('数据加载失败');
                }
            });     
        }
    });
    $("select").select2({dropdownCssClass: 'dropdown-inverse'});
</script>

